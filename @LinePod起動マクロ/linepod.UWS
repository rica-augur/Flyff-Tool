//////////////////////////////////////////////////////////////////////////////////////////////
// 設定
//////////////////////////////////////////////////////////////////////////////////////////////
delay           = 50                                                  		// ☆各操作のディレイ時間(ミリ秒)(数値が小さいほど早い)
retry_over_sec  = 30                                                  		// ☆ランチャー起動待ち時間(秒)
launcher_loadwait_sec  = 1                                                  // ☆ランチャーのロード時間まち(秒)（初期化待ち）
pwcopy_dialog_x = 800														// ☆PWコピーOKのダイアログ表示位置X
pwcopy_dialog_y = 450                                                  		// ☆PWコピーOKのダイアログ表示位置Y

// ランチャー起動パス
launcher_path   = "C:\Windows\System32\schtasks.exe /run /tn LINE-POD"
//launcher_path   = "G:\LINE POD Launcher\pod-client.exe"	
//launcher_path   = "D:\Program Files (x86)\LINE POD Launcher\pod-client.exe"

launcher_kill = 0	// 1:ランチャーを再起動する
Auto_login = 1		// 1:IDPWを自動入力する
Resident = 0		// 1:常駐する(マクロ終了後、アカウント選択に戻る)
popup = 1			// 1:ポップアップで選択する
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWWkWWkkWWQWkWyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWVYTwuZZZZZyyyyyyyyyWHHkkyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyXY!(JuuZZZZZZyZZyyZyZyyyyyyyWHkyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWY!(JTuuuZZZZZXyyZyyZyyyZyyyyyyyyyWWkyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyW=._JzuzuuuuZZZXWZyZyyyyZyyZyZyyZyyyZyXHkyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWY...jzXUuuuuuZZXXHZyZZyyZyyZyyyZyyZWWyyZyyHWWyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyW^_(J-(_?7XuuuZXSKXHZZyZyyyyyyZyyyZyyyXHXZZZyWXHkyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyW^_1uzXSzuXuJvTXKZXZHZZZyZZXyZyyZyyyZZZyZWkZXXr4WHWWyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWt_xXXXKuuuuuuukXkyd0XkZZZZyZKZZyZZXXZZZZZZWHkWt(HyyWHHkyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyZyyyZyyyZyyyyyW.JyXXqXXuuuXkXWHkPdHZWZZZXXXWZyZZZZHZZyZZZVTHkb.(WyyyyHWWWyyyZyyyZyyyZyyyZyyyZyyyZyyyZyyyZyyyZyyyZyyyZyyyZyyyZyyyyyy//
//yyyyyyZyyyyyyZyyyyyyyyyyyyyyyyyyy]-HuWWHXZZWSZZXHHW$JHHZWZZZXWXkZXXwwwwAwwwXZZZWkRXXyyyyyyWWHQyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyW\dWZkkHHZZyyyyXqKW6>HWHHHkZyXXHZZZZZXWZZZZZZuXXXWkuWWyyyyyyyWHHkyyyyyyyyyyyyyyyyyyyyyyyyyWQQQQQkyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWoHWXqkHNyVWNmWWkHd\-qkyWWVWWZVHZyZZZyHZZZZZXKuHmkuUWHWyyyyyyyyWHKWyyyyyyyyyyyyyyyyyyyWMHWWWWHHHHHHkWyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWyHWkHmWQ@?HMm1=.}.-WWVyWWW>WXyyZyZXHZZZZZZHZXkkHWkkXWHkkyyyyyyyWWHkyyyyyyyyyyyyyyyyyyyyyyyyyyyyWHHHkyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyZyyyZyyyZyyyZyyyyHHyWWqkHHM1NNM#~...._?HQmkWKCKXHyyyyXHZWZZZZmZXkkkkHWkXMHHHHHHWyyyyWHHkyyyZyyyZyyyZyyyyyyyyyyyyyyyyyWHHkyyyyZyyyZyyyy//
//yyyyyZyyyyyyyZyyyyyyyyyyyyyyyyyyyyMyyWWHHHD<NHM@......-^`7HMN&$WfVyyyWHXyyZZXqWXWkkkkHXyXWkyyyyyyyyyyyyWWWyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWHHyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWWHkk\_dNJ'....... .mHH@MKTTkWVWHHWyyyyWqyXHHkkkbbkZXWHWyyyyyyyyyyyyWHkyyyyyyyyyyyyyyyyyyyyyyyyyyyyyHHyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWkHkkkq:~_.......... (#dM#MN>jHHHgkkHyyyXkHXHkyHkWkkbWXZZWHkyyyyyyyyyyyyWHkyyyyyyyyyyyyyyyyyyyyyyyyyyyWWkyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWQkHkkkkkkH{....(<..`....,NmJ+MMdyyWHHHHkkkWHkHWkkkyHkXHbbbkXZuXHkWyyyyyyyyyyyWHkyyyyyyyyyyyyyyyyyyyyyyyyWNWHyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyZyyyWM@@@NHHHkkkWkkkkHH@b_... ........._?<<jXyyyyHHkkkkkqkHHkkkHyyHkkWHWbpkXZuuXWHkyyyyyyyyyyWHkyyyZyyyZyyyZyyyyyyyyyWHfWyyyZyyyZyyy//
//yyyyyyZyyyyyyZyyyyyyyW@@HHMHyyyWWHHHHH@H@HHx...-J(--......~_JyyyyyX1HkfWkkkHqkkqkkHyyWkkyXHWWpWkuuuuzzUWWkyyyyyyyHHWyyyyyyyyyyyyyyyyyWWHfWHyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyW@H@HMyyyyyyyWH@@@H@H@H@L...6>+1X-....(XWWyyyWauqkkqkqkkkkqkkkkkyyyHkZZZZWHWWkkuuuzzzzzXWWWkWyWKkyyyyyyyyyyyyWkWHfWTdWyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyWM@HMyyyyyyWH@@HM@@H@H@@H@a_.<<+?_..._XXWyyyyH@HHkkkqkkqkkkqkqkkWyyyXHXZZZZZZUWWkXuuzuUUWQmXz}_?W9UWHHHHHHHWXUY"1(dWyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyMHMWyyyyyH@H@HM@HH@H@@H@@H@a_...._-(jW4WyyZWT9MNkqkqkKkqkkkqkkkkkyyyyWWyZZZZZZZuuXUXuuuuuu274kJ,W;......_-(-JdWyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyZyyyyHWMyyyyyWH@@MHMH@@H@H@H@H@H@HHHH@@2?jWJWyyyy::JHHkkkHkkkqkkkkqkkkkyyyZyWXyZZZZZZZZuuuuuV7~-((JJWWXR&J-.vTWWyyyyyyyyyyyyyyyyZyyyyy//
//yyyyyZyyyyyyyZyyyyyyyWNWHWyyyW@H@#yW@H@@H@H@@@H@@@@HMB~:(<7hWyyyW<<:UMqkkqNHkkqkqkHqkkkkkyyyyyyyyZZZZZZV77iJwZZXXZZZZZHkkyyHWkfkWWWyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyWHpWHWkWH@H#yWH@H@H@@HH@@H@MY=_ <~  `(UWyyy[`_~T@HkkkHMHHkkkqkWHHkkkkWyXUUUXw&++yZZZZZZZZyyWWkyZHHyWHkyyHWpfWNkyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyWHfffVfWHHHHHMMH@@MH@@H#"!` __  `` ._`?Wkyh````.UNHkkkHkHHHHkkqHkWWWHHWWyyyyyyyyZyyyyyyZyZyyyHHHyyVVVHWWyWHWfWHWyyyyyyZyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyWHVVyVVWQHMHHM@H@HMM@< ``.!``` .~ ( ` .?UHn.````?M@HHkkHHWkWHHHHHqkkWkkkkWWWWWWWWWyyyyyyWWWWyyWHHWffpfWHWyWHffWkyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyWkWHHyyWMH@MmkMH@M=<!`.!```.~ ``(;`.< `` ?TWWWAedMMMMMHHHHqqqmmmHHqHHHHHyVWHM@@@@@@@@@HHQkWyVVfWkHHWpfpWNWyHkfWkyyyyyyyyyZyyy//
//yyyyyyZyyyyyyZyyyZyyyyyyyyHWHyyWHHyWHMMMH#'.: _```.``````(`,< ````````_74WqkqHHkVU3(7WyyyyyyyyyyyyyyyyyWMH@@@@@@@@@@@MHkppHkWHHHWfWHyWkfHyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyWHWyyWWHyyyyyyyf~~_.``` ````````(.<``````````````W@HHHHHVyWkVdkyyyyyyyyyyWkkWyyyyHM@@@@@@@@@@@@@HkWHyWHHkHWHkWHWHyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyQqHyyWWWWyyyyyWf_:(. ``._`````````( ```` ._.``````d@@@@@HVyVW@HKMHmQkWyyWMMMMH@kWyyyWM@@@@@H@@@@@@@MHHyyyHHkkWkHHHyyyyZyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyWyyyyyHyHyyyyyW=~~(<~_:~>:~:~:~_-., ``..~ ```_ ``._J@M@@@MVVVfH@@H@@@@@@MMHHmQmkM@kkVyyW@@@@@@@H@@@@@@HNyyyyMHkkkHyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyWHyNyyyyP__<(_1~~_(+(--~~~~:( ``.~`````````.:~J@@@MMfffffW@@@@@@@@@@@@@@@@@@@@@@@@MHM@@@@@@@@H@@@@HNyyyyWHkkNyyyyyyyyyyyyy//
//yyyyyZyyyyyyyZyyyZyyyyyyyyyyyNyHyyyW{~~~~(dfWHHHHWVffpWm>``_``````````.:?jJ@HHpfpWHpWH@@@@gggg@@g@@g@@@@@@@@HH@@@H@@@@@@@@@@@@@HkyWkHHHkHHyyyyyyyyZyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyWHWHyyX_~~~~(dyyyyyyVfffppP` _``````````.:__:(HHHHH@HWWMHkWWHHHHMHHHHHHHHHWWMMyyyyyWHM@@@@@@@@@@@@@HHHHWyyHbHWyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWHHHK~~~~~cyZZyyyyVffWWK`  `````````` :::_<(@M@@M@@gg@gggMHkkyWHHyyyyyyWW@HNyyyyyyyWM@@@@@@@@@@@@H#yyyyyWHHHyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyZyyyyyyyyyyyyWt~~~~~zZZyyyyWWkWWH'  `````````` (::::~_WHHHHgggggggggggg@@gkQQQkH@g@HHyyyyyyyyyW@M@@@@@@@@M@@NyyyyyyNbHyyyyZyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyW~~~~~JTWMMWNWVVffp%  ````.````` ~<~~```.@ggNkWH@gg@ggggggggggggg@HHMWyyyyyyyyyyyW@Mg@@g@@@@MM@MyyyyyyHWHyyyyyyyyyyy//
//yyyyyyZyyyyyyZyyyZyyyyyyyyyyyyyyyyP~~(dkWZXXWyWMm,~:_(Jdk+.```.`````` .-_~JMHgggNkVWMHgggggggHNMMHHWMyyyyyyyyyyyyyyWgHMgg@g@g@HM@#yyyyyWNHyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyZyyyyyyyW{(dWHHWHWHgHkkHMNQpfpppppW,````..(;:<!`.WyWHHgggggHkkHM@HgMHgHHMHyyyyyyyyyyyyyyyyHHHWggggggg#H@HyyyyWWHyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyWdZZZUQHH@HWWyVWfWMHHWpfppppp&.(;::+<``.HyyyyyWHHHHHHHHyyWHmNyyyyyyyyyyWNyyyyyyyyWHNyWggggg@HHHMyyyWWHHyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyyyZyyyyyyyyW9TC&J&d@@HMgkVyVVXnXfWH><?T7TUfWhJ?~```` HyyyyyyyyyyyyyyyyyWHNyyyyyyyyyyyHHkyyyyWWHHyyWgggggHMHHHWHHHyyyyyyyyyyyyZyyyy//
//yyyyyyyyyyyyyyyyyyyyyyyyyyWV"!.?WVVVVVH@HNHmHkyVVXVfWK3:::JfpfWkAXh,`````(yyyyyyyyyyyyyyyyyyH#yyyyyyyyyyyyWHHHHHMHHyyWMggggHNWWHyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyZyyyyyyyZyyyZyyyyyWY' ....~(?4fVVMHNfHmHHHVVWWBC~  :<+HfVVVVVVVh,```.z7TUWWyyyyyyykWWkNHyyyyyyyyyyyyyyyyyyWHkyyWgmgmg@mkMWyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyyyyWV^  ...~~~(_~~(7WMHffWgHmmHg#=  .(?` ~WVVVyVyyyVVW.. >1:` `?4kyyyyyyHHyyyyyyyyyyyyyyyyyyyyyWHHgmgHHHWyyyyyyyyyyyyyyyyyyyyZyyyyyyy//
//yyyyyyyyyyyyyyyyyyyf^``.~~~~~~(`(~:~:(jfpffWHgm#  ..!` `` `JyyWY:(?TTT=?!`<<><    .4Wyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//yyyyyyyyyyyyyyyyyW=``` ~~~~~~~< (+:::(<pffpfH#'  ` `` `````,XY:::<<+<::<-.:+>:~  .` -Wyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                      　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　                                    //
//  ------------------------------------------------------------------梨花ちゃま作成------------------------------------------------------------------  //
//                                                                                        　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　  //
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// ESCキーで強制終了
sethotkey(VK_ESC, 0, "ForceStop")

// OSを判別
//os=KINDOFOS(FALSE)


// ■■ CSVファイル読み込み ■■
FILE = FOPEN("linepod.csv",F_READ or F_WRITE)　//ファイルを開く
number=FGET(FILE,F_LINECOUNT)
DIM name[number]
DIM id[number]
DIM pw[number]
DIM all=""
FOR i = 2 TO number
	a =SPLIT(FGET(FILE,i),",")
	name[i-1]=a[0]
	id[i-1]=a[1]
	pw[i-1]=a[2]
	all = all + (i-1) + ":" + name[i-1] + "<#CR>"
NEXT
FCLOSE(FILE)

WHILE TRUE
	// ■■ 入力待ち ■■
	n = 0
	WHILE n <= 0 OR number <= n
		IF popup = 1
			n = POPUPMENU(all, 0) + 1
		ELSE
			n = INPUT(all, 1,false,G_SCREEN_W/2,G_SCREEN_H/3*2)
		ENDIF
		
		IFB VARTYPE(n) = VAR_EMPTY
			fukidasi("マクロ終了中です。。")
			DOSCMD("taskkill /im UWSC.exe /f")
			exitexit
		ENDIF
		IF n <= 0 OR number <= n
			fukidasi("入力値が不正です")
		ENDIF
	WEND

	// ランチャー再起動
	IF launcher_kill=1
		fukidasi("ランチャー終了中です。。")
		EXEC("C:\Windows\System32\schtasks.exe /end /tn LINE-POD") 
		DOSCMD("taskkill /im pod-client.exe /f")
		SLEEP(1)
		fukidasi("ランチャーを起動中です。。")
		EXEC(launcher_path) 
	ENDIF
			
	// 起動しているかチェック
	wid=GETID("LINE POD")
	// ランチャ再起動モードでなくて、ランチャーが見つからない時は起動する
	IF wid=-1 AND launcher_kill=0
		fukidasi("ランチャーを起動中です。。")
		EXEC(launcher_path) 
	ENDIF
	// 起動中のランチャーがある場合は、ログイン画面まで戻る
	IF wid>=0
		fukidasi("ログイン画面まで戻ります")
		ACW(wid,0,0)
		FOR i = 0 TO 10
			BTN(LEFT,CLICK, 25, 60)
			SLEEP(0.2)
		NEXT
	ENDIF
	
	BTN(LEFT,CLICK,550,568,328)
	SLEEP(0.5)	


	if Auto_login = 1
		// ◆ログイン自動モード
		// ランチャー起動まち
		slice = 1
		start = GETTIME()
		WHILE wid=-1
			fukidasi("ランチャー起動まち")
			IF retry_over_sec < GETTIME() - start
				 PRINT retry_over_sec + "秒 待機しましたが"+ "<#CR>" + "ランチャーが起動しませんでした。"
				 SLEEP(5)
				 DOSCMD("taskkill /im UWSC.exe /f")
				 exitexit
			ENDIF
			SLEEP(slice)
			wid=GETID("LINE POD")
		WEND
				
		SLEEP(launcher_loadwait_sec)

		// アクティブ化
		ACW(wid,0,0)
		BTN(LEFT,CLICK, 200, 100)
		
		// WIN7はログインまで自動化
		fukidasi("自動入力中。。")
		BTN(LEFT,CLICK, 200, 100)
		KBD(VK_TAB,CLICK,delay)
		sendstr(0, id[n]) 
		KBD(VK_CTRL,DOWN,delay) 
		KBD(VK_V,CLICK,delay)
		KBD(VK_CTRL,UP,delay)

		// PW
		KBD(VK_TAB,CLICK,delay)
		sendstr(0, pw[n]) 
		KBD(VK_CTRL,DOWN,delay) 
		KBD(VK_V,CLICK,delay)
		KBD(VK_CTRL,UP,delay)

		// LOGIN
		KBD(VK_TAB,CLICK,delay)
		KBD(VK_RETURN,CLICK,delay)
		fukidasi("ログインしました")
	ELSE
		// ◆ログイン手動モード
		sendstr(0, id[n]) 
		fukidasi("IDをクリップボードにコピーしました")
		MSGBOX("PWをクリップボードにコピーする？",BTN_YES,pwcopy_dialog_x,pwcopy_dialog_y)
		sendstr(0, pw[n]) 
		fukidasi("PWをクリップボードにコピーしました")
	endif
		 
	IF Resident = 0
		exitexit
	ENDIF
	SLEEP(5)
	fukidasi("")
WEND // アカウント選択へ戻る

procedure ForceStop()
	exitexit
fend
